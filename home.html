<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Calculator</title>

    <!--Favicon-->
    <link rel="icon" type="images" href="./images/icon.png">

    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">

    <!--Fontawesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<style>

    *{
        font-family: "Lilita One", sans-serif;
        font-weight: 300;
    }
    html,body{
        height: 100%;
        width: 100%;
        background-image: url(./images/home-background.jpg);
        background-color: #cccccc;
        background-position: center;
        background-size: cover;
        background-attachment: fixed;
        background-repeat: no-repeat;
        display: flex;
        flex-direction: column;
    }
    #nav{
        background: linear-gradient(90deg, rgba(68,255,224,1) 23%, rgba(0,0,0,1) 100%);

    }
    #foot{
        color: white;
        background: linear-gradient(90deg, rgba(224,68,255,1) 23%, rgba(0,0,0,1) 100%);

    }
    #up{
      background: linear-gradient(90deg, rgba(224,68,255,1) 23%, rgba(0,0,0,1) 100%);
    }
    #calc{
      background: linear-gradient(90deg, rgba(250,255,68,1) 50%, rgba(0,255,4,1) 100%);
    }

</style>

<body>
    
    <!--Navbar-->
    <nav id="nav" class="navbar">
        <div class="container-fluid">
          <a id="name" class="navbar-brand"><i class="fa-solid fa-calculator fa-fade"></i></a>
          <form class="d-flex" role="search">
            <button type="button" class="btn btn-info" onclick="logout()"><i class="fa-solid fa-right-from-bracket fa-fade"></i> Log Out</button>
          </form>
        </div>
      </nav>

      <!--Form-->
      <section>
       
        <div id="calc" class="container mt-5 mb-5">
          <form>

            <div class="row">
              <!-- Income Column -->
              <div class="col-md-6 mb-5 mt-4">
                <!-- Dropdown Menu -->
                <div class="mb-3">
                  <label for="dropdown1" class="form-label">Income</label>
                  <select id="dropdown1" class="form-select">
                    <option selected>Salary</option>
                    <option value="1">Side Business</option>
                  </select>
                </div>
        
                <!-- Input Field -->
                <div class="mb-3">
                  <input type="number" class="form-control" id="addincome" placeholder="Enter Amount">
                </div>

                <button type="submit" onclick="addIncome()" class="btn btn-success w-100">Add Income</button>

              </div>
        
              <!-- Expenses Column -->
              <div class="col-md-6 mb-5 mt-4 ">
                <!-- Dropdown Menu -->
                <div class="mb-3">
                  <label for="dropdown2" class="form-label">Select Expense type</label>
                  <select id="dropdown2" class="form-select">
                    <option selected>Emi</option>
                    <option value="1">Fuel</option>
                    <option value="2">Insurance</option>
                    <option value="3">Food</option>
                    <option value="4">Travel</option>
                    <option value="3">Miscellaneous</option>
                  </select>
                </div>
        
                <!-- Input Field -->
                <div class="mb-3">
                  <input type="Number" class="form-control" id="addexpense" placeholder="Enter Amount">
                </div>
                <button type="submit" onclick="addExpense()" class="btn btn-warning w-100">Add Expense</button>
              </div>

              <div class="container mb-5">
                <div class="row text-center" style="justify-content: center;">
                  <div class="col-lg-3 col-md-2"></div>
                  <div id="balance" class="col-lg-3 col-md-4 col-sm-4 col-5 mt-5">
                    <h4>TOTAL BALANCE</h4>
                    <hr />
                    <p id="total_balance"></p>
                  </div>
        
                  <div id="expense" class="col-lg-3 col-md-4 col-sm-4 col-5 mt-5">
                    <h4>TOTAL EXPENSE</h4>
                    <hr />
                    <p id="total_expense"></p>
                  </div>
                  <div class="col-lg-3 col-md-2"></div>
                </div>
              </div>

            </div>

            <div class="container" id="details">
                <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                  <h2 class="text text-center">YOUR EXPENSES</h2>
                  <hr>
                  <table class="table-warning bg-white text-center w-100">
                    <thead>
                      <tr class="table-warning">
                        <th scope="col">Type</th>
                        <th scope="col">Amount</th>
                        <th scope="col">Balance</th>
                        <th scope="col">Date & Time</th>
                      </tr>
                    </thead>
                    <tbody id="expense_table"></tbody>
                  </table>
                </div>


            </div>

            <div class="clear text-center">
              <button class="btn btn-info p-2 m-5" type="submit" onclick="clearall()">Clear All <i class="fa-solid fa-eraser"></i></button>
            </div>

      
          </div>

        
          </form>
        </div>


      </section>

      <!--Footer-->
      <footer class="text-center text-lg-start">
        <!-- Copyright -->
        <div id="foot" class="text-center p-3">
          Â© 2024 Copyright:
          <a class="text-white" href="">Budget Calculator.com</a>
        </div>
        <!-- Copyright -->
      </footer>


</body>

<script>

function logout(){
    if (confirm("Are you sure you want to log out?")) {
        localStorage.removeItem("username");
        window.location.href='./index.html';
    }
}

let key = localStorage.getItem("username");
console.log(key);
let user_data = JSON.parse(localStorage.getItem(key)) || {
income: 0,
expense: 0,
}; // Default values if not set
console.log(user_data);


function addIncome() {
   let incometype = document.getElementById("addincometype").value;
   let incomeAmount = parseFloat(document.getElementById("addincome").value);

   if (incometype === "" || isNaN(incomeAmount) || incomeAmount <= 0) {
      alert("Please fill all the details correctly");
   } else {
      let currentDateTime = new Date().toLocaleString();

      user_data.balance = (parseFloat(user_data.balance) || 0) + incomeAmount;
      user_data.income = user_data.income || [];
      user_data.income.push({
         type: incometype,
         amount: incomeAmount,
         balance: user_data.balance,
         dt: currentDateTime,
      });

      localStorage.setItem(key, JSON.stringify(user_data));

      document.getElementById("total_balance").textContent = `RS ${user_data.balance}/-`;
      alert("added income successfully")
    }
}



function addExpense() {
   let expenseAmount = parseFloat(
   document.getElementById("addexpense").value);
   let expensetype = document.getElementById("addexpensetype").value;
   
   if (expensetype == "" || isNaN(expenseAmount)) {
      alert("please fill all the fields");
   } else if (user_data.balance < expenseAmount) {
      alert("insufficient balance");
   } else {
      let currentDateTime = new Date().toLocaleString();
      user_data.totalexpense = (parseFloat(user_data.totalexpense) || 0) + expenseAmount;
      user_data.balance = parseFloat(user_data.balance) - expenseAmount;

      user_data.expense = user_data.expense || [];
      user_data.expense.push({
        type: expensetype,
        amount: expenseAmount,
        balance: user_data.balance,
        dt: currentDateTime,
      });

      document.getElementById("total_balance").textContent = `RS ${user_data.balance}/-`;
      localStorage.setItem(key, JSON.stringify(user_data));
      document.getElementById("total_expense").textContent = `Rs ${user_data.totalexpense}/-`;
      alert("added expense successfully")
   }
}

let expenserows = user_data.expense.map((a) => `
    <tr>
        <td>${a.type}</td>
        <td><span style="color:red;padding-left:40px;font-weight:900">-</span>${a.amount}</td>
        <td><span style="padding-left:30px;">${a.balance}</span></td>
        <td><span style="font-size:14px;font-weight:900">${a.dt}</span></td>
    </tr>
`).join(""); // Join the array into a single string
expense_table.innerHTML = expenserows;


function clearall() {
  if (confirm("Are you sure you want to clear your data?")) {

    user_data.balance = 0;
    user_data.totalexpense = 0;
    user_data.expense = [];
    user_data.income = [];
  
    localStorage.setItem(key, JSON.stringify(user_data));

    document.getElementById("total_balance").textContent = `RS 0/-`;
    document.getElementById("total_expense").textContent = `Rs 0/-`;
    income_table.innerHTML = ""; 
    expense_table.innerHTML = ""; 
  }
  alert("cleared data successfully")
}

</script>

</html>